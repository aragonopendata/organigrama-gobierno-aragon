<!DOCTYPE html>
<html lang="es"><head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Organigrama del Gobierno de Aragón</title>
  <link rel="icon" type="image/x-icon" href="https://aplicaciones.aragon.es/favicon.ico">
  <link href="css/main.css" rel="stylesheet" type="text/css">
  <link href="css/clay.css" rel="stylesheet" type="text/css">
  <link href="css/styles.css" rel="stylesheet" type="text/css">
</head>

<body class="controls-visible default-color-scheme yui3-skin-sam guest-site signed-out public-page site">

  <div id="senna_surface1-screen_2" style="display: block;" class="flipped">

   <nav class="quick-access-nav" id="dvqk_quickAccessNav" aria-label="Saltar zonas del contenido">
    <ul>
      <li><a href="#content" class="js-salto-contenido" accesskey="0">Salto a contenido</a></li>
      <li><a href="#footer" class="js-salto-nav" accesskey="2">Saltar a navegación en el pie de la página</a></li>
    </ul>
  </nav>

  <div class="container-fluid dga-view px-0" id="wrapper">
    <header id="header" class="header" aria-label="Cabecera" role="banner" tabindex="-1">

    </header>
    <p class="c-txt-small text-right p-3" id="versionApp"></p>
    <main id="content" class="container detail-news-module__body-news__description">
        <div class="row">
          <div class="col">
            <h1 class="c-h1 mt-5">Organigrama de Gobierno de Aragón</h1>
            <p class="c-p-lg mt-3 mb-3" id="fecha_legislatura"></p>
            <p class="mb-5 pb-5"><a class="c-link" href="ArbolDepartamentosServlet">Ver Organigrama completo</a></p>
          </div>
        </div>

	<div id="areaLvl1">
	</div>
        <h2 class="c-h2 mb-5" id="departamentos">Departamentos</h2>
    <div id="areaLvl2">
    </div>
    </main>
    <footer id="footer" role="contentinfo" class="footer mt-48" tabindex="-1">
      
    </footer>
  </div>
</div>
<script
  src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
<script src="js/main.js"></script>
<script>
window.onload = function() {
	  init();
	};
	
function init(){
	generacionHeader();
	generacionFooter();
	fechaLegislaturaActual();
	entidadesLvl1();
	entidadesLvl2();
	version();
}

function fechaLegislaturaActual(){
    var url = "IndexServlet?accion=1";
    const xhttp = new XMLHttpRequest();
    xhttp.onreadystatechange = function(){
        if(this.readyState == 4 && this.status == 200){ 
			var textoRecuperado = this.responseText;
			var parrafo = document.getElementById('fecha_legislatura');
		    var texto = document.createTextNode('Inicio de la legislatura: '+ textoRecuperado);
		    parrafo.prepend(texto);
        }else{
            //console.log('Ha habido un error, esperábamos respuesta 4-200 y hemos recibido "+this.readyState+" - "+this.status+"');
        }
    };
    xhttp.open("GET", url, true);
    xhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
    xhttp.send(null);
}

function entidadesLvl1(){
    var url = "IndexServlet?accion=2";
    const xhttp = new XMLHttpRequest();
    xhttp.onreadystatechange = function(){
        if(this.readyState == 4 && this.status == 200){ //Si la conexión ha sido un éxito...
			var paginaRecuperada = this.responseText;
        	document.getElementById("areaLvl1").insertAdjacentHTML('afterBegin', paginaRecuperada);
        }else{
            //console.log('Ha habido un error, esperábamos respuesta 4-200 y hemos recibido "+this.readyState+" - "+this.status+"');
        }
    };
    xhttp.open("GET", url, true);
    xhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
    xhttp.send(null);
}

function entidadesLvl2(){
    var url = "IndexServlet?accion=3";
    const xhttp = new XMLHttpRequest();
    xhttp.onreadystatechange = function(){
        if(this.readyState == 4 && this.status == 200){
			var paginaRecuperada = this.responseText;
        	document.getElementById("areaLvl2").insertAdjacentHTML('afterBegin', paginaRecuperada);
        }else{
            //console.log('Ha habido un error, esperábamos respuesta 4-200 y hemos recibido "+this.readyState+" - "+this.status+"');
        }
    };
    xhttp.open("GET", url, true);
    xhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
    xhttp.send(null);
}

function version(){
    var url = "IndexServlet?accion=4";
    const xhttp = new XMLHttpRequest();
    xhttp.onreadystatechange = function(){
        if(this.readyState == 4 && this.status == 200){ 
			var textoRecuperado = this.responseText;
			var parrafo = document.getElementById('versionApp');
		    var texto = document.createTextNode('versión: '+ textoRecuperado);
		    parrafo.prepend(texto);
        }else{
            //console.log('Ha habido un error, esperábamos respuesta 4-200 y hemos recibido "+this.readyState+" - "+this.status+"');
        }
    };
    xhttp.open("GET", url, true);
    xhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
    xhttp.send(null);
}

function generacionHeader(){
    var url = "IndexServlet?accion=5";
    const xhttp = new XMLHttpRequest();
    xhttp.onreadystatechange = function(){
        if(this.readyState == 4 && this.status == 200){ //Si la conexión ha sido un éxito...
			var paginaRecuperada = this.responseText;
        	document.getElementById("header").insertAdjacentHTML('afterBegin', paginaRecuperada);
        }else{
            //console.log('Ha habido un error, esperábamos respuesta 4-200 y hemos recibido "+this.readyState+" - "+this.status+"');
        }
    };
    xhttp.open("GET", url, true);
    xhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
    xhttp.send(null);
}

function generacionFooter(){
    var url = "IndexServlet?accion=6";
    const xhttp = new XMLHttpRequest();
    xhttp.onreadystatechange = function(){
        if(this.readyState == 4 && this.status == 200){ //Si la conexión ha sido un éxito...
			var paginaRecuperada = this.responseText;
        	document.getElementById("footer").insertAdjacentHTML('afterBegin', paginaRecuperada);
        }else{
            //console.log('Ha habido un error, esperábamos respuesta 4-200 y hemos recibido "+this.readyState+" - "+this.status+"');
        }
    };
    xhttp.open("GET", url, true);
    xhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
    xhttp.send(null);
}
</script>
</body>
</html>